<!DOCTYPE html><html lang="en-us" class="__variable_93ed5b scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/static/images/clydedsouza.jpg"/><link rel="preload" as="image" href="/static/posts/1*cxAr7Kz9jvQZe2y0BxMAEQ.png"/><link rel="stylesheet" href="/_next/static/css/991d5e3381d79286.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/37f456282b5838dd.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a821df72551a909a.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/252e266d7553d403.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-f3708453bb364bdf.js"/><script src="/_next/static/chunks/4bd1b696-98996ba8cc797b60.js" async=""></script><script src="/_next/static/chunks/684-0b3a53281fbb8ae0.js" async=""></script><script src="/_next/static/chunks/main-app-49d9f86c159264bb.js" async=""></script><script src="/_next/static/chunks/c857e369-7d101bd487d2337f.js" async=""></script><script src="/_next/static/chunks/c16f53c3-046ed8a6addafdf8.js" async=""></script><script src="/_next/static/chunks/63-ad55bcfce8e065c4.js" async=""></script><script src="/_next/static/chunks/874-746d756fcfba86f0.js" async=""></script><script src="/_next/static/chunks/95-4fad12d9cc13c226.js" async=""></script><script src="/_next/static/chunks/app/layout-face4d0c09455148.js" async=""></script><script src="/_next/static/chunks/641-47b4c4efd59f87b8.js" async=""></script><script src="/_next/static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js" async=""></script><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4666761687967451" crossorigin="anonymous"></script><meta name="next-size-adjust" content=""/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon-76x76.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/apple-touch-icon-57x57.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/apple-touch-icon-57x57.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/apple-touch-icon-120x120.png" color="#10984d"/><meta name="google-adsense-account" content="ca-pub-4666761687967451"/><meta name="msapplication-TileColor" content="#10984d"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#10984d"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#10984d"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><title>Creating a Short URL Service Using Cloudflare Workers | Clyde&#x27;s Blog</title><meta name="description" content="Deploy serverless code instantly across the globe"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers"/><link rel="alternate" type="application/rss+xml" href="https://blog.clydedsouza.net/feed.xml"/><meta property="og:title" content="Creating a Short URL Service Using Cloudflare Workers"/><meta property="og:description" content="Deploy serverless code instantly across the globe"/><meta property="og:url" content="https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers"/><meta property="og:site_name" content="Clyde&#x27;s Blog"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://blog.clydedsouza.net/static/posts/guidepost1.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2022-01-27T00:00:00.000Z"/><meta property="article:modified_time" content="2022-01-27T00:00:00.000Z"/><meta property="article:author" content="Clyde D&#x27;Souza"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Creating a Short URL Service Using Cloudflare Workers"/><meta name="twitter:description" content="Deploy serverless code instantly across the globe"/><meta name="twitter:image" content="https://blog.clydedsouza.net/static/posts/guidepost1.jpg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-950 dark:text-white"><script>((e,t,r,n,o,i,a,s)=>{let u=document.documentElement,l=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&i?o.map(e=>i[e]||e):o;r?(u.classList.remove(...n),u.classList.add(i&&i[t]?i[t]:t)):u.setAttribute(e,t)}),r=t,s&&l.includes(r)&&(u.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=a&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><header class="border-t-primary-500 sticky top-0 z-50 flex h-14 w-full items-center justify-between border-t-4 bg-white/95 px-8 py-4 backdrop-blur-lg dark:bg-gray-950"><a class="break-words" aria-label="Clyde&#x27;s Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><img alt="Picture of the author" width="35" height="35" decoding="async" data-nimg="1" style="color:transparent;border-radius:100px" src="/static/images/clydedsouza.jpg"/></div><div class="hidden text-xl font-semibold md:block">Clyde&#x27;s Blog</div></div></a><div class="flex items-center space-x-4 leading-5 sm:-mr-6 sm:space-x-6"><button aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="hover:text-primary-500 dark:hover:text-primary-400 h-6 w-6 text-gray-900 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><div class="no-scrollbar hidden max-w-80 items-center gap-x-4 overflow-x-auto sm:flex md:max-w-72 lg:max-w-96"><a class="hover:text-primary-500 dark:hover:text-primary-400 m-1 text-sm font-medium text-gray-900 dark:text-gray-100" href="/posts">All posts</a></div><a class="flex items-center justify-center gap-4 rounded-full bg-black px-2 py-1 text-sm text-white transition-colors duration-200 hover:bg-teal-500 focus:bg-teal-500 sm:px-4 sm:py-2 dark:bg-teal-500 dark:hover:bg-black dark:focus:bg-black" target="_blank" rel="noopener noreferrer" href="https://clydedsouza.net"><span class="whitespace-nowrap">Visit my website</span></a><button aria-label="Toggle Menu" class="sm:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="hover:text-primary-500 dark:hover:text-primary-400 h-8 w-8 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><span hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></span></div></header><main class="mb-auto"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Creating a Short URL Service Using Cloudflare Workers","datePublished":"2022-01-27T00:00:00.000Z","dateModified":"2022-01-27T00:00:00.000Z","description":"Deploy serverless code instantly across the globe","image":"/static/posts/guidepost1.jpg","url":"https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers","author":[{"@type":"Person","name":"Clyde D'Souza"}]}</script><section class="mx-auto max-w-7xl px-2 sm:px-6 xl:max-w-7xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="cursor-pointer rounded-full bg-gray-100 p-2 text-gray-500 transition-all hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="#009688"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="cursor-pointer rounded-full bg-gray-100 p-2 text-gray-500 transition-all hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="#009688"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article class="xl:dark:divide-gray-700"><header class="py-6"><div class="space-y-1 text-center"><dl class="space-y-4"><div><dt class="sr-only">Published on</dt><span class="ml-2 inline-block align-middle text-lg text-gray-700 font-stretch-ultra-condensed dark:text-gray-300"><time dateTime="2022-01-27T00:00:00.000Z">January 27, 2022</time></span><span class="ml-2">Â·</span><dt class="sr-only">Reading time</dt><span class="ml-2 inline-block align-middle text-lg text-gray-700 font-stretch-ultra-condensed dark:text-gray-300">13 min read</span></div></dl><div><h1 class="text-3xl leading-9 font-extrabold text-gray-800 font-stretch-ultra-condensed sm:text-4xl sm:leading-10 md:text-[42px] md:leading-14 dark:text-gray-100">Creating a Short URL Service Using Cloudflare Workers</h1></div><div><h2 class="text-xl leading-10 font-medium tracking-tight text-slate-500 sm:text-2xl md:text-2xl dark:text-gray-100">Deploy serverless code instantly across the globe</h2></div><div class="block md:hidden"><div class="my-2"><h2 class="mb-2 text-xs font-bold tracking-wide text-gray-800 uppercase dark:text-gray-400">Share this page</h2><div class="flex justify-center gap-1"><button aria-label="email" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#7f7f7f"></circle><path d="M17,22v20h30V22H17z M41.1,25L32,32.1L22.9,25H41.1z M20,39V26.6l12,9.3l12-9.3V39H20z" fill="white"></path></svg></button><button aria-label="linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#3b5998"></circle><path d="M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z" fill="white"></path></svg></button><button aria-label="reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button><button aria-label="twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#000000"></circle><path d="M 41.116 18.375 h 4.962 l -10.8405 12.39 l 12.753 16.86 H 38.005 l -7.821 -10.2255 L 21.235 47.625 H 16.27 l 11.595 -13.2525 L 15.631 18.375 H 25.87 l 7.0695 9.3465 z m -1.7415 26.28 h 2.7495 L 24.376 21.189 H 21.4255 z" fill="white"></path></svg></button><button aria-label="telegram" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#37aee2"></circle><path d="m45.90873,15.44335c-0.6901,-0.0281 -1.37668,0.14048 -1.96142,0.41265c-0.84989,0.32661 -8.63939,3.33986 -16.5237,6.39174c-3.9685,1.53296 -7.93349,3.06593 -10.98537,4.24067c-3.05012,1.1765 -5.34694,2.05098 -5.4681,2.09312c-0.80775,0.28096 -1.89996,0.63566 -2.82712,1.72788c-0.23354,0.27218 -0.46884,0.62161 -0.58825,1.10275c-0.11941,0.48114 -0.06673,1.09222 0.16682,1.5716c0.46533,0.96052 1.25376,1.35737 2.18443,1.71383c3.09051,0.99037 6.28638,1.93508 8.93263,2.8236c0.97632,3.44171 1.91401,6.89571 2.84116,10.34268c0.30554,0.69185 0.97105,0.94823 1.65764,0.95525l-0.00351,0.03512c0,0 0.53908,0.05268 1.06412,-0.07375c0.52679,-0.12292 1.18879,-0.42846 1.79109,-0.99212c0.662,-0.62161 2.45836,-2.38812 3.47683,-3.38552l7.6736,5.66477l0.06146,0.03512c0,0 0.84989,0.59703 2.09312,0.68132c0.62161,0.04214 1.4399,-0.07726 2.14229,-0.59176c0.70766,-0.51626 1.1765,-1.34683 1.396,-2.29506c0.65673,-2.86224 5.00979,-23.57745 5.75257,-27.00686l-0.02107,0.08077c0.51977,-1.93157 0.32837,-3.70159 -0.87096,-4.74991c-0.60054,-0.52152 -1.2924,-0.7498 -1.98425,-0.77965l0,0.00176zm-0.2072,3.29069c0.04741,0.0439 0.0439,0.0439 0.00351,0.04741c-0.01229,-0.00351 0.14048,0.2072 -0.15804,1.32576l-0.01229,0.04214l-0.00878,0.03863c-0.75858,3.50668 -5.15554,24.40802 -5.74203,26.96472c-0.08077,0.34417 -0.11414,0.31959 -0.09482,0.29852c-0.1756,-0.02634 -0.50045,-0.16506 -0.52679,-0.1756l-13.13468,-9.70175c4.4988,-4.33199 9.09945,-8.25307 13.744,-12.43229c0.8218,-0.41265 0.68483,-1.68573 -0.29852,-1.70681c-1.04305,0.24584 -1.92279,0.99564 -2.8798,1.47502c-5.49971,3.2626 -11.11882,6.13186 -16.55882,9.49279c-2.792,-0.97105 -5.57873,-1.77704 -8.15298,-2.57601c2.2336,-0.89555 4.00889,-1.55579 5.75608,-2.23009c3.05188,-1.1765 7.01687,-2.7042 10.98537,-4.24067c7.94051,-3.06944 15.92667,-6.16346 16.62028,-6.43037l0.05619,-0.02283l0.05268,-0.02283c0.19316,-0.0878 0.30378,-0.09658 0.35471,-0.10009c0,0 -0.01756,-0.05795 -0.00351,-0.04566l-0.00176,0zm-20.91715,22.0638l2.16687,1.60145c-0.93418,0.91311 -1.81743,1.77353 -2.45485,2.38812l0.28798,-3.98957" fill="white"></path></svg></button><button aria-label="whatsapp" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#25D366"></circle><path d="m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915" fill="white"></path></svg></button></div></div></div></div></header><div class="grid-rows-[auto_1fr] pb-8 xl:grid xl:grid-cols-4 xl:gap-x-6"><div class="pt-2 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose dark:prose-invert max-w-none pb-8"><figure class="mb-2"><img alt="An image of a directional post as the featured image for this article." loading="lazy" width="954" height="536.63" decoding="async" data-nimg="1" class="mb-0 aspect-16/9 object-cover pb-1" style="color:transparent" src="/static/posts/guidepost1.jpg"/><figcaption><center>Image source: <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://unsplash.com/photos/rzJKYpq2is4">Unsplash</a></center></figcaption></figure><h3 class="content-header mt-8 mb-6" id="introduction"><a class="break-words" href="#introduction" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Introduction</h3><p>Have you ever used a short URL service like bitly or something similar and wondered how it works? Better yet, would you like to create one for yourself? If you&#x27;ve answered yes to both these questions, then you&#x27;re in the right place. In this article, we&#x27;ll look at creating a short URL service using <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://workers.cloudflare.com/">Cloudflare Workers</a>.</p><h3 class="content-header mt-8 mb-6" id="what-are-cloudflare-workers"><a class="break-words" href="#what-are-cloudflare-workers" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>What are Cloudflare Workers?</h3><p><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://workers.cloudflare.com/">Cloudflare Workers</a> allows you to deploy serverless code to Cloudflare&#x27;s edge network which means that your code will be available instantly from anywhere across the globe. You don&#x27;t have to worry about scaling it and the cost to run your code is super cheap. Cloudflare Workers comes with a global, low-latency key-value data store called <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://developers.cloudflare.com/workers/learning/how-kv-works">Workers KV</a>. In this article, we&#x27;ll be using Workers KV along with Cloudflare Workers.</p><h3 class="content-header mt-8 mb-6" id="step-1-sign-up-for-cloudflare"><a class="break-words" href="#step-1-sign-up-for-cloudflare" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #1: Sign up for Cloudflare</h3><p>Visit <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://cloudflare.com/">cloudflare.com</a> and sign up for a free account. Once you&#x27;ve verified your email address and gotten access to your dashboard, you may see a message to add a site â you don&#x27;t need to add a site, just skip to the dashboard page and click on <strong>Workers</strong>.</p><div><div><img alt="Screenshot showing how to access Cloudflare Workers." loading="lazy" width="389" height="236" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_l5vratkH9Ls6vBw7gUyg_w.png"/></div></div><p>Since this is your first time using Cloudflare Workers, you&#x27;ll be asked to set up a subdomain. This subdomain name is unique to you and will identify all Workers deployed to your account. Enter a suitable subdomain and then click on <strong>Set up</strong> to proceed to the next step.</p><div><div><img alt="Screenshot showing how to configure a subdomain for Cloudflare Workers." loading="lazy" width="776" height="603" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_UX8yzI1rPWIC2JUFjPihFQ.png"/></div></div><p>In the next step, we&#x27;ll continue with the free plan since we&#x27;re going to use this for learning purposes only. In the final step, verify your email and then you&#x27;re good to go.</p><p>From the Workers dashboard page, you won&#x27;t see any Workers listed because we haven&#x27;t created any. For now, just copy the <strong>Account ID</strong> which should be visible in the right panel.</p><div><div><img alt="Screenshot showing how to get the account ID from Cloudflare." loading="lazy" width="375" height="305" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_fac3j6pJ7ivpLo0y5vMyHg.png"/></div></div><h3 class="content-header mt-8 mb-6" id="step-2-set-up-your-development-environment"><a class="break-words" href="#step-2-set-up-your-development-environment" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #2: Set up your development environment</h3><p>We&#x27;ll be using the Wrangler CLI for various development tasks, so if you haven&#x27;t already, please install the CLI tool on your local machine by following <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://developers.cloudflare.com/workers/cli-wrangler/install-update">this official Cloudflare guide</a>.</p><p>Login to your Cloudflare account using the Wrangler CLI tool using the command <code>wrangler login</code>. It&#x27;s recommended to open up a command prompt with administrator privileges.</p><p>This should open Cloudflare in the browser and you might require to authorize Wrangler. Cloudflare will show a message when it&#x27;s alright to close the page. Back in the console, you should see a message telling you that everything was successfully configured.</p><h3 class="content-header mt-8 mb-6" id="step-3-generate-some-code"><a class="break-words" href="#step-3-generate-some-code" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #3: Generate some code</h3><p>In a local folder, run the command <code>wrangler generate shorturl https://github.com/cloudflare/worker-template</code> to generate some code based on a template from Cloudflare&#x27;s <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/cloudflare/worker-template">GitHub repository</a>.</p><div><div><img alt="Screenshot showing the console output of the entered wrangler commands." loading="lazy" width="805" height="219" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_X_nQAkFFOE6r5VR4t3hdVA.png"/></div></div><p>As instructed in the console output, we need to update the <code>wrangler.toml</code> file and add the account ID to that. As per <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/cloudflare/wrangler/issues/209#issuecomment-541654484">this comment</a>, it&#x27;s ok to commit the <code>wrangler.toml</code> file to source control. The information contained in this file is not sensitive.</p><div class="relative"><pre><code class="code-highlight language-toml"><span class="code-line"><span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;WORKER_NAME&quot;</span>
</span><span class="code-line"><span class="token key property">type</span> <span class="token punctuation">=</span> <span class="token string">&quot;javascript&quot;</span>
</span><span class="code-line"><span class="token key property">account_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;YOUR ACCOUNT ID&quot;</span>
</span></code></pre></div><p>Finally, if you run the command <code>wrangler dev</code>, you should see the following output.</p><div><div><img alt="Screenshot showing the Worker in action locally." loading="lazy" width="309" height="117" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_gV1OJWEoMxWjjxqIorEwsA.png"/></div></div><h3 class="content-header mt-8 mb-6" id="step-4-get-a-short-url-and-redirect"><a class="break-words" href="#step-4-get-a-short-url-and-redirect" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #4: Get a short URL and redirect</h3><p>In the <code>index.js</code> file, replace the <code>handleRequest()</code> method with the code snippet below. We&#x27;re fetching the entire request URL from the object received, then getting the pathname from that, and then simply redirecting the user to example.com with the same pathname suffixed. For example, heading over to our development Worker URL <code>127.0.0.1:8787/abc</code> will redirect the user to <code>https://example.com/abc</code>. If no pathname is supplied, then a simple text message is printed in the browser. Give this a test using the command <code>wrangler dev</code>.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token keyword">const</span> base <span class="token operator">=</span> <span class="token string">&#x27;https://example.com&#x27;</span>
</span><span class="code-line"><span class="token keyword">const</span> statusCode <span class="token operator">=</span> <span class="token number">301</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> pathname <span class="token punctuation">}</span> <span class="token operator">=</span> url
</span><span class="code-line">  <span class="token keyword">const</span> destinationURL <span class="token operator">=</span> base <span class="token operator">+</span> pathname
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>pathname <span class="token operator">===</span> <span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token string">&#x27;Hello worker!&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property literal-property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property string-property">&#x27;content-type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;text/plain&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">Response</span><span class="token punctuation">.</span><span class="token function property-access method">redirect</span><span class="token punctuation">(</span>destinationURL<span class="token punctuation">,</span> statusCode<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 class="content-header mt-8 mb-6" id="step-5-map-the-path-with-a-static-set"><a class="break-words" href="#step-5-map-the-path-with-a-static-set" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #5 Map the path with a static set</h3><p>The next step is to make it slightly more dynamic and in line with how the final storage would look like. We&#x27;ve added the <code>getRedirectURL()</code> method that simply gets the redirect URL based on the key supplied. In the <code>handleRequest()</code> method, we&#x27;ve modified a line to use the <code>getRedirectURL()</code> method.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token keyword">const</span> urls <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property literal-property">google</span><span class="token operator">:</span> <span class="token string">&#x27;https://www.google.com&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property literal-property">facebook</span><span class="token operator">:</span> <span class="token string">&#x27;https://www.facebook.com&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">getRedirectURL</span><span class="token punctuation">(</span><span class="token parameter">pathname</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> urls<span class="token punctuation">[</span>pathname<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&#x27;/&#x27;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// Same as before</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> redirectURL <span class="token operator">=</span> <span class="token function">getRedirectURL</span><span class="token punctuation">(</span>pathname<span class="token punctuation">.</span><span class="token function property-access method">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token language-regex regex-source"><span class="token function anchor">^</span><span class="token escape">\/</span></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>redirectURL <span class="token operator">===</span> <span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token string">&#x27;Not a valid identifier&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property literal-property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property string-property">&#x27;content-type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;text/plain&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token maybe-class-name">Response</span><span class="token punctuation">.</span><span class="token function property-access method">redirect</span><span class="token punctuation">(</span>redirectURL<span class="token punctuation">,</span> statusCode<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>So far we&#x27;ve got a static list of short URLs and their redirects. Now it&#x27;s time to make it dynamic.</p><h3 class="content-header mt-8 mb-6" id="step-6-setting-up-kv-storage"><a class="break-words" href="#step-6-setting-up-kv-storage" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #6: Setting up KV storage</h3><p>Rather than storing a static list of the keys and the corresponding websites it redirects to, we&#x27;ll be using Cloudflare&#x27;s KV storage.</p><p>Let&#x27;s start by running the command <code>wrangler kv:namespace create âSHORTURLSâ</code> where <code>SHORTURLS</code> is the name I used for my KV namespace. This commands prints a message in the console that instructs to add the KV configuration to the <code>wrangler.toml</code> file.</p><div><div><img alt="Screenshot showing the console output of the entered wrangler commands." loading="lazy" width="633" height="127" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_g_EX-IiZwPppI7nZ-AuL6A.png"/></div></div><h3 class="content-header mt-8 mb-6" id="step-7-seeding-the-kv-storage"><a class="break-words" href="#step-7-seeding-the-kv-storage" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #7: Seeding the KV storage</h3><p>To quickly test our application out, let&#x27;s use the following command to add one record into the database.</p><div class="relative"><pre><code class="code-highlight language-shell"><span class="code-line">wrangler kv:key put <span class="token parameter variable">--binding</span><span class="token operator">=</span><span class="token operator">&lt;</span>BINDING NAME<span class="token operator">&gt;</span> â<span class="token operator">&lt;</span>KEY<span class="token operator">&gt;</span>â â<span class="token operator">&lt;</span>URL<span class="token operator">&gt;</span>&quot;
</span></code></pre></div><p>In the repository I&#x27;m working on, I&#x27;ve updated the command to <code>wrangler kv:key put --binding=SHORTURLS âtwitterâ âhttps://twitter.com/clydedz&quot;</code>. If all goes well, you should immediately see a success message.</p><p>Now, if you try to run the command <code>wrangler dev</code> you should see an error message that might look something like this:</p><blockquote><p>Error: In order to preview a worker with KV namespaces, you must designate a preview_id in your configuration file for each KV namespace<br/>you&#x27;d like to preview.</p></blockquote><div><div><img alt="Screenshot showing the console output of the entered wrangler commands." loading="lazy" width="977" height="68" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_fyYIgdq1T1kMKjppIfD7sg.png"/></div></div><p>After reading <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/cloudflare/wrangler/issues/1458#issuecomment-671465444">this useful GitHub answer</a>, it became clear that all we needed was a preview environment. When we created the namespace earlier, it was associated with your production environment. So, when you test it out using <code>wrangler dev</code>, it doesn&#x27;t let you manipulate your production KV storage from your development environment.</p><h3 class="content-header mt-8 mb-6" id="step-8-setting-up-a-preview-kv-environment"><a class="break-words" href="#step-8-setting-up-a-preview-kv-environment" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #8: Setting up a preview KV environment</h3><p>To fix this, we&#x27;ll need to repeat the KV creation steps exactly as before, but this time we&#x27;ll add the argument <code>--preview</code> indicating that we need a preview, i.e. development instance created.</p><div><div><img alt="Screenshot showing the console output of the entered wrangler commands." loading="lazy" width="816" height="101" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_X0Y7qIFeesMrK5ZgEr_HGg.png"/></div></div><p>Because we entered the same KV namespace name, notice how the primary <code>id</code> is still the same original one, and in addition to that, we&#x27;ve been assigned a <code>preview_id</code>.</p><p>If you try to run the application now, the Worker will work but heading over to <code>/twitter</code> will not redirect you to the Twitter URL. The reason for this is that we&#x27;ve only seeded our production environment of the KV namespace. Now that we&#x27;re connecting to preview, we&#x27;ll also need to seed this preview namespace with a test record. I&#x27;m going to run the following command as we did before, but this time I&#x27;m going to add the <code>--preview</code> argument.</p><div class="relative"><pre><code class="code-highlight language-shell"><span class="code-line">wrangler kv:key put <span class="token parameter variable">--binding</span><span class="token operator">=</span>SHORTURLS âtwitterâ âhttps://twitter.com/clydedz&quot; --preview.
</span></code></pre></div><h3 class="content-header mt-8 mb-6" id="step-9-retrieve-values-from-kv-storage"><a class="break-words" href="#step-9-retrieve-values-from-kv-storage" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #9: Retrieve values from KV storage</h3><p>We&#x27;ll now update the <code>getRedirectURL()</code> method to use our KV namespace to get the value instead of a local static collection. Note, we&#x27;ve written<code>SHORTURLS.get()</code> to match our binding name which is named <code>SHORTURLS</code>. So, if your binding name was <code>XYZ</code>, then you&#x27;d update this code to <code>XYZ.get()</code>. I&#x27;ve also updated this method to be asynchronous.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getRedirectURL</span><span class="token punctuation">(</span><span class="token parameter">pathname</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token constant">SHORTURLS</span><span class="token punctuation">.</span><span class="token function property-access method">get</span><span class="token punctuation">(</span>pathname<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> value <span class="token operator">||</span> <span class="token string">&#x27;/&#x27;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Finally, let&#x27;s run the application locally to test it out. As you can see in the GIF below, it now works as expected.</p><div><div><img alt="GIF showing the redirection in action." loading="lazy" width="560" height="208" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_BWD9UbqD9m_K4gjQWvcIpQ.gif"/></div></div><h3 class="content-header mt-8 mb-6" id="step-10-automating-deployments"><a class="break-words" href="#step-10-automating-deployments" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #10: Automating deployments</h3><p>We wouldn&#x27;t want to manually deploy our Cloudflare Worker every time we make changes now, would we? For automated deployments, we&#x27;ll take a look at GitHub Actions since my repository is already source controlled in GitHub.</p><h4 class="content-header mt-8 mb-6" id="github-workflow-file"><a class="break-words" href="#github-workflow-file" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>GitHub workflow file</h4><p>A GitHub workflow file is a YAML file that allows you to configure your build and deploy pipeline via code. I&#x27;ll explain what we&#x27;ve used for this project, but if you&#x27;re keen to read more about GitHub workflow, please check out their <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://docs.github.com/en/actions">official documentation here</a>.</p><p>Let&#x27;s start by adding the below code snippet to a file called <code>build-deploy.yml</code> and store this file in the <code>.github/workflows/</code> folder.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy Cloudflare Worker
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">on</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">push</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> main
</span><span class="code-line">
</span><span class="code-line"><span class="token key atrule">jobs</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
</span><span class="code-line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy shorturl worker
</span><span class="code-line">    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Publish
</span><span class="code-line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> cloudflare/wrangler<span class="token punctuation">-</span>action@1.3.0
</span><span class="code-line">        <span class="token key atrule">with</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">apiToken</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.CF_API_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">          <span class="token key atrule">workingDirectory</span><span class="token punctuation">:</span> <span class="token string">&#x27;shorturl&#x27;</span>
</span></code></pre></div><p>We start by giving it a nice descriptive name using the <code>name</code> keyword. Then, using the <code>on</code> keyword, we&#x27;re configuring this pipeline to run every time code is pushed to the main branch.</p><p>In the last section of this file, we&#x27;re using the <code>jobs</code> keyword to define a job which is nothing but a batch of steps that will be executed. The keyword <code>deploy</code> is just an identifier for this job and could&#x27;ve been named anything else, too. The keyword <code>steps</code> contains the individual steps that will make the deployment happen.</p><p>We&#x27;re using a GitHub Action from the marketplace called <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/marketplace/actions/checkout">actions/checkout</a> to check out the code from our Git repository. Next, we&#x27;re using <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/marketplace/actions/deploy-to-cloudflare-workers-with-wrangler">cloudflare/wrangler-action</a> provided by Cloudflare to deploy our Worker to Cloudflare. Instead of hardcoding the API token, which is required for this step to authenticate against our Cloudflare account, we&#x27;re using the GitHub secret variable called <code>CF_API_TOKEN</code>. The prefix <code>secrets</code> and the curly braces around it just a syntax for accessing <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">GitHub secrets</a>. Don&#x27;t worry, we&#x27;ll look at adding this secret in the next step.</p><p>We&#x27;re using the <code>workingDirectory</code> keyword to set the working directory of our Cloudflare Worker to a subdirectory (relative to the root directory) because the code for our Worker isn&#x27;t in the root directory, which is usually the default setting â more on this decision below.</p><h4 class="content-header mt-8 mb-6" id="cloudflare-token"><a class="break-words" href="#cloudflare-token" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Cloudflare token</h4><p>Navigate to the <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://dash.cloudflare.com/profile/api-tokens">API Tokens page</a> in Cloudflare and then click on the <strong>Create Token</strong> button.</p><div><div><img alt="Screenshot showing how to create a new API token." loading="lazy" width="1049" height="377" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_uHucyp-XXEn32Rqvqfhm0g.png"/></div></div><p>From the API token templates page, we&#x27;ll click on the <strong>Use template</strong> button beside the <strong>Edit Cloudflare Workers</strong> line item.</p><div><div><img alt="Screenshot showing how to use an existing template to create an API token." loading="lazy" width="720" height="492" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_4U7ZaLs4jxiN8oTsWbnUfQ.png"/></div></div><p>On the next page, from the <strong>Account resources</strong> and <strong>Zone resources</strong> dropdowns, select your account (the email address should show up in these dropdowns) from the dropdown. If you are a user of multiple Cloudflare accounts, you&#x27;ll need to be careful to select the right account.</p><p>Continue to the summary, then click on the <strong>Create Token</strong> button. Copy the token and save it securely.</p><div><div><img alt="Screenshot showing how to create a token in Cloudflare." loading="lazy" width="1024" height="332" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_F6E6VF-kO35iqU9rC98DCg.png"/></div></div><h4 class="content-header mt-8 mb-6" id="add-secret-in-github"><a class="break-words" href="#add-secret-in-github" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Add secret in GitHub</h4><p>Since we&#x27;ve used the variable <code>CF_API_TOKEN</code> in the Workflow file, let&#x27;s add a secret of the same name in GitHub. Click on <strong>Settings</strong>, then click on <strong>Secrets</strong> and then <strong>New secret</strong>. Type the secret variable name <code>CF_API_TOKEN</code> and in the <strong>Value</strong> field, enter the Cloudflare API token we generated earlier. Click on <strong>Add secret</strong> button to save these changes.</p><div><div><img alt="Screenshot showing how to add a secret in GitHub." loading="lazy" width="1009" height="602" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_aBbi8J8rKopUZWBPw3A3Bw.png"/></div></div><h3 class="content-header mt-8 mb-6" id="step-11-final-checks"><a class="break-words" href="#step-11-final-checks" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Step #11: Final checks</h3><p>Now that we&#x27;ve got all the items in place, don&#x27;t forget to commit and push the changes to your Workflow file. If everything has been set up well, you should see a successful run in the <strong>Actions</strong> tab in GitHub.</p><div><div><img alt="Screenshot of the GitHub Actions tab." loading="lazy" width="1265" height="354" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_y69YYHGn9fnNC6m3hgdQmw.png"/></div></div><p>Now, if you head over to the Workers page in your Cloudflare account, you should see the Worker you just deployed pop up on the screen.</p><div><div><img alt="Image showing how to see the Worker in the Cloudflare dashboard." loading="lazy" width="814" height="579" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_y7ffTi0BLi-TPSJ6ha9jPA.png"/></div></div><p>Head over to the Worker URL and test if the URL redirection works. We can still test the <code>&lt;URL of your Worker&gt;/twitter</code> short URL since we seeded that data earlier.</p><div><div><img alt="GIF showing the redirection in action." loading="lazy" width="674" height="168" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_YHmeK66PEc-RGyQSIFXtug.gif"/></div></div><hr/><h3 class="content-header mt-8 mb-6" id="whats-next"><a class="break-words" href="#whats-next" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>What&#x27;s next?</h3><h4 class="content-header mt-8 mb-6" id="unit-testing"><a class="break-words" href="#unit-testing" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Unit testing</h4><p>We didn&#x27;t look at writing unit tests and setting up test coverage for brevity. However, in a real-life solution, you&#x27;d want to consider unit testing your code and also include the required steps in your CI/CD pipeline.</p><h4 class="content-header mt-8 mb-6" id="adding-more-workers"><a class="break-words" href="#adding-more-workers" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Adding more Workers</h4><p>In the article above, we only looked at a Worker that redirects us to the destination URL after we supply it with a short URL. If you&#x27;re trying to create a full-fledged short URL service, you&#x27;d also want to create one that allows us to create a new short URL mapping that will act as the backend, and potentially a microservice that will help post analytics for every hit on the short URL and also fetch these analytics back.</p><div><div><img alt="Diagram showing how multiple Workers come together to form a complete solution." loading="lazy" width="9229" height="5101" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_YC-pmfE9i4QZI3qw_HumJQ.png"/></div></div><p>Handdrawn diagram created by the author</p><h4 class="content-header mt-8 mb-6" id="source-controlling-multiple-workers"><a class="break-words" href="#source-controlling-multiple-workers" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Source controlling multiple Workers</h4><p>You don&#x27;t have to create different Git repositories to host each Cloudflare Worker. You can create a monorepo for all your Workers and have subfolders with contents for each Worker. This works great if you&#x27;re sharing code between different workers, so you don&#x27;t end up repeating it.</p><div><div><img alt="Diagram showing how to host multiple workers in the same repository." loading="lazy" width="5080" height="5448" decoding="async" data-nimg="1" style="color:transparent" src="/static/posts/1_t6vUl_1ITc5D_P3GpKRS3w.png"/></div></div><p>Handdrawn diagram created by the author</p><h4 class="content-header mt-8 mb-6" id="bundling-into-a-single-javascript-file"><a class="break-words" href="#bundling-into-a-single-javascript-file" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Bundling into a single JavaScript file</h4><p>We&#x27;ve also written all our JavaScript code in a single file which isn&#x27;t ideal. Out of the box, we cannot import another JavaScript file into our Worker&#x27;s <code>index.js</code> file. To get around this, we can decouple the source code from the final generated Worker JavaScript file. What I mean by that is (also illustrated above), we maintain our source code for a Worker in a folder called <code>src</code>, for example, and then run a process like <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://webpack.js.org/">webpack</a> to bundle and generate a single JavaScript file into a destination folder, let&#x27;s call this <code>dist</code>. The contents of this destination folder are what we can then publish to Cloudflare.</p><h4 class="content-header mt-8 mb-6" id="custom-domain"><a class="break-words" href="#custom-domain" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Custom domain</h4><p>If you&#x27;re building a full-fledge solution, you may also be looking at setting up a custom domain name for your Workers â this is indeed possible and your final solution might look something like the diagram below, using bit.ly as the domain name for reference.</p><p><img alt="High-level architecture diagram showing all components involved in a full-fledged short URL service." src="/static/posts/1*cxAr7Kz9jvQZe2y0BxMAEQ.png"/></p><p>Handdrawn diagram created by the author</p><hr/><h3 class="content-header mt-8 mb-6" id="source-code"><a class="break-words" href="#source-code" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Source code</h3><p>If you&#x27;d like to see the full source code for this project, it&#x27;s available on <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/ClydeDz/shorturl-cloudflare-workers">GitHub</a>. In the same repository, you&#x27;ll also find a <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/ClydeDz/shorturl-cloudflare-workers/blob/main/cloudflare.ps1">PowerShell script</a> that contains all the commands we&#x27;ve used above.</p><p>That&#x27;s it. Thanks for reading.</p></div><div class="pt-6 pb-6 text-center text-gray-700 dark:text-gray-300" id="comment"></div></div><aside><div class="grid grid-cols-1 items-start gap-x-8 md:grid-cols-2 xl:grid-cols-1 xl:gap-y-4"><dl class="pb-2 xl:pt-2"><dt class="sr-only">Authors</dt><dd><ul class="flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-y-8 xl:space-x-0"><div><li class="mb-4 flex items-center space-x-2"><div><img alt="avatar" loading="lazy" width="38" height="38" decoding="async" data-nimg="1" class="h-10 w-10 rounded-full" style="color:transparent" src="/static/images/clydedsouza.jpg"/></div><dl class="text-sm leading-5 font-medium whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Clyde D&#x27;Souza</dd><dt class="sr-only">Twitter</dt><dd><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="https://twitter.com/clydedz">@clydedz</a></dd></dl></li><li class="mb-4 flex items-center space-x-2"><dt class="sr-only">Author bio</dt><dd class="text-sm text-gray-600 dark:text-gray-100">Hi, I&#x27;m Clyde. I&#x27;m a software engineer and digital content creator based in Auckland, New Zealand. I write about various technologies, teach online classes, make videos, and I&#x27;m also the author of a children&#x27;s bedtime storybook!</dd></li><li><dt class="sr-only">Kofi support button</dt><a href="https://ko-fi.com/L3L026ITT" target="_blank" class="mr-2 inline-block"><div><img alt="Buy Me a Coffee at ko-fi.com" loading="lazy" width="127" height="32" decoding="async" data-nimg="1" class="rounded-full" style="color:transparent;border:0px;height:32px" src="https://storage.ko-fi.com/cdn/kofi6.png?v=6"/></div></a><dt class="sr-only">Sponsor me button</dt><a href="https://sponsor.clydedsouza.net/" target="_blank" class="inline-block"><div><img alt="Sponsor me button" loading="lazy" width="127" height="32" decoding="async" data-nimg="1" class="rounded-full" style="color:transparent;border:0px;height:32px" src="/static/images/sponsorme.png"/></div></a></li></div></ul></dd></dl></div><div class="mt-6 hidden xl:block"><div class="my-2"><h2 class="mb-2 text-xs font-bold tracking-wide text-gray-800 uppercase dark:text-gray-400">Share this page</h2><div class="flex justify-left gap-1"><button aria-label="email" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#7f7f7f"></circle><path d="M17,22v20h30V22H17z M41.1,25L32,32.1L22.9,25H41.1z M20,39V26.6l12,9.3l12-9.3V39H20z" fill="white"></path></svg></button><button aria-label="linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#3b5998"></circle><path d="M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z" fill="white"></path></svg></button><button aria-label="reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button><button aria-label="twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#000000"></circle><path d="M 41.116 18.375 h 4.962 l -10.8405 12.39 l 12.753 16.86 H 38.005 l -7.821 -10.2255 L 21.235 47.625 H 16.27 l 11.595 -13.2525 L 15.631 18.375 H 25.87 l 7.0695 9.3465 z m -1.7415 26.28 h 2.7495 L 24.376 21.189 H 21.4255 z" fill="white"></path></svg></button><button aria-label="telegram" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#37aee2"></circle><path d="m45.90873,15.44335c-0.6901,-0.0281 -1.37668,0.14048 -1.96142,0.41265c-0.84989,0.32661 -8.63939,3.33986 -16.5237,6.39174c-3.9685,1.53296 -7.93349,3.06593 -10.98537,4.24067c-3.05012,1.1765 -5.34694,2.05098 -5.4681,2.09312c-0.80775,0.28096 -1.89996,0.63566 -2.82712,1.72788c-0.23354,0.27218 -0.46884,0.62161 -0.58825,1.10275c-0.11941,0.48114 -0.06673,1.09222 0.16682,1.5716c0.46533,0.96052 1.25376,1.35737 2.18443,1.71383c3.09051,0.99037 6.28638,1.93508 8.93263,2.8236c0.97632,3.44171 1.91401,6.89571 2.84116,10.34268c0.30554,0.69185 0.97105,0.94823 1.65764,0.95525l-0.00351,0.03512c0,0 0.53908,0.05268 1.06412,-0.07375c0.52679,-0.12292 1.18879,-0.42846 1.79109,-0.99212c0.662,-0.62161 2.45836,-2.38812 3.47683,-3.38552l7.6736,5.66477l0.06146,0.03512c0,0 0.84989,0.59703 2.09312,0.68132c0.62161,0.04214 1.4399,-0.07726 2.14229,-0.59176c0.70766,-0.51626 1.1765,-1.34683 1.396,-2.29506c0.65673,-2.86224 5.00979,-23.57745 5.75257,-27.00686l-0.02107,0.08077c0.51977,-1.93157 0.32837,-3.70159 -0.87096,-4.74991c-0.60054,-0.52152 -1.2924,-0.7498 -1.98425,-0.77965l0,0.00176zm-0.2072,3.29069c0.04741,0.0439 0.0439,0.0439 0.00351,0.04741c-0.01229,-0.00351 0.14048,0.2072 -0.15804,1.32576l-0.01229,0.04214l-0.00878,0.03863c-0.75858,3.50668 -5.15554,24.40802 -5.74203,26.96472c-0.08077,0.34417 -0.11414,0.31959 -0.09482,0.29852c-0.1756,-0.02634 -0.50045,-0.16506 -0.52679,-0.1756l-13.13468,-9.70175c4.4988,-4.33199 9.09945,-8.25307 13.744,-12.43229c0.8218,-0.41265 0.68483,-1.68573 -0.29852,-1.70681c-1.04305,0.24584 -1.92279,0.99564 -2.8798,1.47502c-5.49971,3.2626 -11.11882,6.13186 -16.55882,9.49279c-2.792,-0.97105 -5.57873,-1.77704 -8.15298,-2.57601c2.2336,-0.89555 4.00889,-1.55579 5.75608,-2.23009c3.05188,-1.1765 7.01687,-2.7042 10.98537,-4.24067c7.94051,-3.06944 15.92667,-6.16346 16.62028,-6.43037l0.05619,-0.02283l0.05268,-0.02283c0.19316,-0.0878 0.30378,-0.09658 0.35471,-0.10009c0,0 -0.01756,-0.05795 -0.00351,-0.04566l-0.00176,0zm-20.91715,22.0638l2.16687,1.60145c-0.93418,0.91311 -1.81743,1.77353 -2.45485,2.38812l0.28798,-3.98957" fill="white"></path></svg></button><button aria-label="whatsapp" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#25D366"></circle><path d="m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915" fill="white"></path></svg></button></div></div></div><div class="my-6 grid grid-cols-2 items-start gap-x-8 xl:grid-cols-1 xl:gap-y-4"><div class="text-sm font-medium"><div><h2 class="text-xs font-bold tracking-wide text-gray-800 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><span class="mt-2 mr-2 inline-flex items-center rounded-full bg-gray-100 px-5 py-2 text-sm text-gray-600 hover:bg-gray-50">Cloudflare Workers</span><span class="mt-2 mr-2 inline-flex items-center rounded-full bg-gray-100 px-5 py-2 text-sm text-gray-600 hover:bg-gray-50">Cloudflare</span><span class="mt-2 mr-2 inline-flex items-center rounded-full bg-gray-100 px-5 py-2 text-sm text-gray-600 hover:bg-gray-50">Software Development</span><span class="mt-2 mr-2 inline-flex items-center rounded-full bg-gray-100 px-5 py-2 text-sm text-gray-600 hover:bg-gray-50">Serverless Architecture</span><span class="mt-2 mr-2 inline-flex items-center rounded-full bg-gray-100 px-5 py-2 text-sm text-gray-600 hover:bg-gray-50">Serverless Computing</span></div></div></div><div class="text-sm font-medium"><div><h2 class="text-xs font-bold tracking-wide text-gray-800 uppercase dark:text-gray-400">Reading list</h2><div class="flex flex-wrap"><span class="mt-2 mr-2 inline-flex items-center rounded-full bg-gray-100 px-5 py-2 text-sm text-gray-600 hover:bg-gray-50">Cloudflare</span></div></div></div></div><div class="flex justify-center"><div class="my-2 h-fit w-[302px]"><a target="_blank" rel="noopener noreferrer mx-auto" class="no-underline" href="https://mamatellmeastory.clydedsouza.net/"><img alt="" loading="lazy" width="302" height="302" decoding="async" data-nimg="1" class="mx-auto my-0 mt-0 mb-0 aspect-1/1 object-cover py-0" style="color:transparent" src="/static/ads/mtmas-kindle.jpg"/><div class="mx-auto px-0 py-1 text-right text-xs font-medium text-black/50 no-underline">Blog ad</div><div class="sr-only">Image showing the book Mama, Tell Me a Story</div></a></div></div><div><h2 class="mb-2 block text-xs font-bold tracking-wide text-gray-800 uppercase dark:text-gray-400">Next reads</h2><div class="grid grid-cols-2 items-start gap-x-8 xl:grid-cols-1 xl:gap-y-4"><a href="/posts/what-are-nfts-and-why-are-people-buying-them"><div><div class="relative aspect-[16/9] w-full"><img alt="What are NFTs and why are people buying them?" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" src="/static/posts/nfts.jpg"/></div><h3 class="pt-2 text-lg font-bold text-gray-800 dark:text-slate-50">What are NFTs and why are people buying them?</h3><p class="my-1 max-h-100 text-base text-ellipsis text-gray-600 text-slate-600 dark:text-slate-100">Everything you need to know about NFTs</p><div class="my-1 max-w-3xl text-sm text-gray-500 dark:text-slate-200">13 min read</div><div class="my-1 max-w-3xl text-sm text-gray-500 dark:text-slate-200">Published <time dateTime="2022-02-06T00:00:00.000Z">February 6, 2022</time></div></div></a><a href="/posts/building-a-chrome-extension-that-also-runs-like-a-website"><div><div class="relative aspect-[16/9] w-full"><img alt="Building a Chrome Extension That Also Runs Like a Website" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" src="/static/posts/chromeleaves.png"/></div><h3 class="pt-2 text-lg font-bold text-gray-800 dark:text-slate-50">Building a Chrome Extension That Also Runs Like a Website</h3><p class="my-1 max-h-100 text-base text-ellipsis text-gray-600 text-slate-600 dark:text-slate-100">A practical example of factory pattern decoupling</p><div class="my-1 max-w-3xl text-sm text-gray-500 dark:text-slate-200">6 min read</div><div class="my-1 max-w-3xl text-sm text-gray-500 dark:text-slate-200">Published <time dateTime="2022-01-17T00:00:00.000Z">January 17, 2022</time></div></div></a></div></div></aside></div></article></section></main><footer><div class="mt-6 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:clyde@clydedsouza.net"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Mail</title><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/ClydeDz"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/@clydedz"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Youtube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/clydedz/"><span class="sr-only">linkedin</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Linkedin</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/clydedz"><span class="sr-only">x</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Copyright Â©<!-- --> <a class="hover:text-primary-500 cursor-pointer hover:underline" target="_blank" rel="noopener noreferrer" href="https://clydedsouza.net">Clyde D&#x27;Souza</a> <!-- -->2025<!-- -->.</div><div>All rights reserved.</div></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Thanks to this blog theme</a></div></div></footer><script src="/_next/static/chunks/webpack-f3708453bb364bdf.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[2947,[\"933\",\"static/chunks/c857e369-7d101bd487d2337f.js\",\"545\",\"static/chunks/c16f53c3-046ed8a6addafdf8.js\",\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"95\",\"static/chunks/95-4fad12d9cc13c226.js\",\"177\",\"static/chunks/app/layout-face4d0c09455148.js\"],\"RegisterAnalytics\"]\n3:I[446,[\"933\",\"static/chunks/c857e369-7d101bd487d2337f.js\",\"545\",\"static/chunks/c16f53c3-046ed8a6addafdf8.js\",\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"95\",\"static/chunks/95-4fad12d9cc13c226.js\",\"177\",\"static/chunks/app/layout-face4d0c09455148.js\"],\"ThemeProviders\"]\n4:I[9243,[\"933\",\"static/chunks/c857e369-7d101bd487d2337f.js\",\"545\",\"static/chunks/c16f53c3-046ed8a6addafdf8.js\",\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"95\",\"static/chunks/95-4fad12d9cc13c226.js\",\"177\",\"static/chunks/app/layout-face4d0c09455148.js\"],\"\"]\n5:I[7392,[\"933\",\"static/chunks/c857e369-7d101bd487d2337f.js\",\"545\",\"static/chunks/c16f53c3-046ed8a6addafdf8.js\",\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"95\",\"static/chunks/95-4fad12d9cc13c226.js\",\"177\",\"static/chunks/app/layout-face4d0c09455148.js\"],\"KBarSearchProvider\"]\n6:I[6874,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"\"]\n7:I[3063,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"Image\"]\n8:I[4159,[\"933\",\"static/chunks/c857e369-7d101bd487d2337f.js\",\"545\",\"static/chunks/c16f53c3-046ed8a6addafdf8.js\",\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"95\",\"static/chunks/95-4fad12d9cc13c226.js\",\"177\",\"static/chunks/app/layout-face4d0c09455148.js\"],\"KBarButton\"]\n"])</script><script>self.__next_f.push([1,"9:I[7773,[\"933\",\"static/chunks/c857e369-7d101bd487d2337f.js\",\"545\",\"static/chunks/c16f53c3-046ed8a6addafdf8.js\",\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"95\",\"static/chunks/95-4fad12d9cc13c226.js\",\"177\",\"static/chunks/app/layout-face4d0c09455148.js\"],\"default\"]\na:I[7555,[],\"\"]\nb:I[1295,[],\"\"]\nd:I[9665,[],\"OutletBoundary\"]\n10:I[9665,[],\"ViewportBoundary\"]\n12:I[9665,[],\"MetadataBoundary\"]\n14:I[6614,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/991d5e3381d79286.css\",\"style\"]\n:HL[\"/_next/static/css/37f456282b5838dd.css\",\"style\"]\n:HL[\"/_next/static/css/a821df72551a909a.css\",\"style\"]\n:HL[\"/_next/static/css/252e266d7553d403.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"oscSY-0MPVMnPtFuskdJZ\",\"p\":\"\",\"c\":[\"\",\"posts\",\"creating-a-short-url-service-using-cloudflare-workers\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"creating-a-short-url-service-using-cloudflare-workers\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/991d5e3381d79286.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/37f456282b5838dd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_93ed5b scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"76x76\",\"href\":\"/static/favicons/apple-touch-icon-76x76.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/static/favicons/apple-touch-icon-57x57.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/static/favicons/apple-touch-icon-57x57.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/static/favicons/apple-touch-icon-120x120.png\",\"color\":\"#10984d\"}],[\"$\",\"meta\",null,{\"name\":\"google-adsense-account\",\"content\":\"ca-pub-4666761687967451\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#10984d\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#10984d\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#10984d\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}],[\"$\",\"body\",null,{\"className\":\"bg-white text-black antialiased dark:bg-gray-950 dark:text-white\",\"children\":[[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4666761687967451\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"$L2\",null,{}],[\"$\",\"$L3\",null,{\"children\":[[\"$undefined\",[[\"$\",\"$L4\",null,{\"strategy\":\"lazyOnload\",\"id\":\"sa-script\",\"children\":\"\\n            window.sa_event=window.sa_event||function(){var a=[].slice.call(arguments);window.sa_event.q?window.sa_event.q.push(a):window.sa_event.q=[a]};\\n        \"}],[\"$\",\"$L4\",null,{\"strategy\":\"lazyOnload\",\"src\":\"https://scripts.simpleanalyticscdn.com/latest.js\"}]],\"$undefined\",\"$undefined\",\"$undefined\",\"$undefined\"],[\"$\",\"$L5\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"/search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"border-t-primary-500 sticky top-0 z-50 flex h-14 w-full items-center justify-between border-t-4 bg-white/95 px-8 py-4 backdrop-blur-lg dark:bg-gray-950\",\"children\":[[\"$\",\"$L6\",null,{\"className\":\"break-words\",\"href\":\"/\",\"aria-label\":\"Clyde's Blog\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mr-3\",\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/images/clydedsouza.jpg\",\"width\":35,\"height\":35,\"style\":{\"borderRadius\":\"100px\"},\"priority\":true,\"alt\":\"Picture of the author\"}]}],[\"$\",\"div\",null,{\"className\":\"hidden text-xl font-semibold md:block\",\"children\":\"Clyde's Blog\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 leading-5 sm:-mr-6 sm:space-x-6\",\"children\":[[\"$\",\"$L8\",null,{\"aria-label\":\"Search\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 h-6 w-6 text-gray-900 dark:text-gray-100\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"div\",null,{\"className\":\"no-scrollbar hidden max-w-80 items-center gap-x-4 overflow-x-auto sm:flex md:max-w-72 lg:max-w-96\",\"children\":[[\"$\",\"$L6\",\"All posts\",{\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 m-1 text-sm font-medium text-gray-900 dark:text-gray-100\",\"href\":\"/posts\",\"children\":\"All posts\"}]]}],[\"$\",\"a\",null,{\"className\":\"flex items-center justify-center gap-4 rounded-full bg-black px-2 py-1 text-sm text-white transition-colors duration-200 hover:bg-teal-500 focus:bg-teal-500 sm:px-4 sm:py-2 dark:bg-teal-500 dark:hover:bg-black dark:focus:bg-black\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://clydedsouza.net\",\"children\":[\"$\",\"span\",null,{\"className\":\"whitespace-nowrap\",\"children\":\"Visit my website\"}]}],false,[\"$\",\"$L9\",null,{}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-7xl px-2 sm:px-6 xl:max-w-7xl xl:px-0\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"py-6 text-5xl font-extrabold tracking-tight text-gray-900 sm:text-5xl sm:leading-10 md:text-5xl md:leading-14 dark:text-gray-100\",\"children\":\"Sorry, this page doesn't exist.\"}],[\"$\",\"div\",null,{\"className\":\"flex w-full flex-wrap\",\"children\":\"Try heading to the homepage for a fresh start or using the search above to look for content.\"}],[\"$\",\"div\",null,{\"className\":\"my-6 flex w-full flex-wrap\",\"children\":[\"$\",\"$L6\",null,{\"className\":\"bg-primary-500 flex items-center justify-center gap-4 rounded-full px-4 py-2 text-white transition-colors duration-200 hover:bg-slate-800 focus:bg-slate-800 sm:px-8 sm:py-2\",\"href\":\"/\",\"children\":\"Back to homepage\"}]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"mt-6 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-3 flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"mailto:clyde@clydedsouza.net\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mail\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Mail\"}],[\"$\",\"path\",null,{\"d\":\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"}],[\"$\",\"path\",null,{\"d\":\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/ClydeDz\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"GitHub\"}],[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]]}]]}],null,[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.youtube.com/@clydedz\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"youtube\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Youtube\"}],[\"$\",\"path\",null,{\"d\":\"M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.linkedin.com/in/clydedz/\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"linkedin\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Linkedin\"}],[\"$\",\"path\",null,{\"d\":\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"}]]}]]}],null,null,[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://twitter.com/clydedz\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"x\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"X\"}],[\"$\",\"path\",null,{\"d\":\"M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z\"}]]}]]}],null,null,null]}],[\"$\",\"div\",null,{\"className\":\"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"children\":[\"Copyright Â©\",\" \",[\"$\",\"a\",null,{\"className\":\"hover:text-primary-500 cursor-pointer hover:underline\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://clydedsouza.net\",\"children\":\"Clyde D'Souza\"}],\" \",2025,\".\"]}],[\"$\",\"div\",null,{\"children\":\"All rights reserved.\"}]]}],[\"$\",\"div\",null,{\"className\":\"mb-8 text-sm text-gray-500 dark:text-gray-400\",\"children\":[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/timlrx/tailwind-nextjs-starter-blog\",\"children\":\"Thanks to this blog theme\"}]}]]}]}]]}]]}]]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"creating-a-short-url-service-using-cloudflare-workers\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$Lc\",\"$undefined\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a821df72551a909a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/252e266d7553d403.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$Ld\",null,{\"children\":[\"$Le\",\"$Lf\",null]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"MR823ndRfe2p-DX7Q_efs\",{\"children\":[[\"$\",\"$L10\",null,{\"children\":\"$L11\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$L12\",null,{\"children\":\"$L13\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$14\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"15:I[3428,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"default\"]\n16:I[1130,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"PostHeader\"]\n17:I[2100,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"default\"]\n18:I[1954,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"default\"]\n19:I[3926,[\"63\",\"static/chunks/63-ad55bcfce8e065c4.js\",\"874\",\"static/chunks/874-746d756fcfba86f0.js\",\"641\",\"static/chunks/641-47b4c4efd59f87b8.js\",\"156\",\"static/chunks/app/posts/%5B...slug%5D/page-df88b9f0909334b2.js\"],\"PostAside\"]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"Creating a Short URL Service Using Cloudflare Workers\\\",\\\"datePublished\\\":\\\"2022-01-27T00:00:00.000Z\\\",\\\"dateModified\\\":\\\"2022-01-27T00:00:00.000Z\\\",\\\"description\\\":\\\"Deploy serverless code instantly across the globe\\\",\\\"image\\\":\\\"/static/posts/guidepost1.jpg\\\",\\\"url\\\":\\\"https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Clyde D'Souza\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-7xl px-2 sm:px-6 xl:max-w-7xl xl:px-0\",\"children\":[[\"$\",\"$L15\",null,{}],[\"$\",\"article\",null,{\"className\":\"xl:dark:divide-gray-700\",\"children\":[[\"$\",\"$L16\",null,{\"content\":{\"title\":\"Creating a Short URL Service Using Cloudflare Workers\",\"date\":\"2022-01-27T00:00:00.000Z\",\"tags\":[\"Cloudflare Workers\",\"Cloudflare\",\"Software Development\",\"Serverless Architecture\",\"Serverless Computing\"],\"readingList\":[\"Cloudflare\"],\"lastmod\":\"2022-01-27T00:00:00.000Z\",\"draft\":false,\"subtitle\":\"Deploy serverless code instantly across the globe\",\"images\":[\"/static/posts/guidepost1.jpg\"],\"type\":\"Blog\",\"readingTime\":{\"text\":\"13 min read\",\"minutes\":12.61,\"time\":756600,\"words\":2522},\"slug\":\"creating-a-short-url-service-using-cloudflare-workers\",\"path\":\"posts/creating-a-short-url-service-using-cloudflare-workers\",\"filePath\":\"posts/creating-a-short-url-service-using-cloudflare-workers.mdx\",\"toc\":[{\"value\":\"Introduction\",\"url\":\"#introduction\",\"depth\":3},{\"value\":\"What are Cloudflare Workers?\",\"url\":\"#what-are-cloudflare-workers\",\"depth\":3},{\"value\":\"Step #1: Sign up for Cloudflare\",\"url\":\"#step-1-sign-up-for-cloudflare\",\"depth\":3},{\"value\":\"Step #2: Set up your development environment\",\"url\":\"#step-2-set-up-your-development-environment\",\"depth\":3},{\"value\":\"Step #3: Generate some code\",\"url\":\"#step-3-generate-some-code\",\"depth\":3},{\"value\":\"Step #4: Get a short URL and redirect\",\"url\":\"#step-4-get-a-short-url-and-redirect\",\"depth\":3},{\"value\":\"Step #5 Map the path with a static set\",\"url\":\"#step-5-map-the-path-with-a-static-set\",\"depth\":3},{\"value\":\"Step #6: Setting up KV storage\",\"url\":\"#step-6-setting-up-kv-storage\",\"depth\":3},{\"value\":\"Step #7: Seeding the KV storage\",\"url\":\"#step-7-seeding-the-kv-storage\",\"depth\":3},{\"value\":\"Step #8: Setting up a preview KV environment\",\"url\":\"#step-8-setting-up-a-preview-kv-environment\",\"depth\":3},{\"value\":\"Step #9: Retrieve values from KV storage\",\"url\":\"#step-9-retrieve-values-from-kv-storage\",\"depth\":3},{\"value\":\"Step #10: Automating deployments\",\"url\":\"#step-10-automating-deployments\",\"depth\":3},{\"value\":\"GitHub workflow file\",\"url\":\"#github-workflow-file\",\"depth\":4},{\"value\":\"Cloudflare token\",\"url\":\"#cloudflare-token\",\"depth\":4},{\"value\":\"Add secret in GitHub\",\"url\":\"#add-secret-in-github\",\"depth\":4},{\"value\":\"Step #11: Final checks\",\"url\":\"#step-11-final-checks\",\"depth\":3},{\"value\":\"What's next?\",\"url\":\"#whats-next\",\"depth\":3},{\"value\":\"Unit testing\",\"url\":\"#unit-testing\",\"depth\":4},{\"value\":\"Adding more Workers\",\"url\":\"#adding-more-workers\",\"depth\":4},{\"value\":\"Source controlling multiple Workers\",\"url\":\"#source-controlling-multiple-workers\",\"depth\":4},{\"value\":\"Bundling into a single JavaScript file\",\"url\":\"#bundling-into-a-single-javascript-file\",\"depth\":4},{\"value\":\"Custom domain\",\"url\":\"#custom-domain\",\"depth\":4},{\"value\":\"Source code\",\"url\":\"#source-code\",\"depth\":3}],\"structuredData\":{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Creating a Short URL Service Using Cloudflare Workers\",\"datePublished\":\"2022-01-27T00:00:00.000Z\",\"dateModified\":\"2022-01-27T00:00:00.000Z\",\"description\":\"Deploy serverless code instantly across the globe\",\"image\":\"/static/posts/guidepost1.jpg\",\"url\":\"https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers\",\"author\":[{\"@type\":\"Person\",\"name\":\"Clyde D'Souza\"}]}}}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] pb-8 xl:grid xl:grid-cols-4 xl:gap-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-2 xl:col-span-3 xl:row-span-2 xl:pb-0\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose dark:prose-invert max-w-none pb-8\",\"children\":[[\"$\",\"figure\",null,{\"className\":\"mb-2\",\"children\":[[\"$\",\"$L7\",null,{\"src\":\"/static/posts/guidepost1.jpg\",\"alt\":\"An image of a directional post as the featured image for this article.\",\"className\":\"mb-0 aspect-16/9 object-cover pb-1\",\"height\":536.63,\"width\":954}],[\"$\",\"figcaption\",null,{\"children\":[\"$\",\"center\",null,{\"children\":[\"Image source: \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://unsplash.com/photos/rzJKYpq2is4\",\"children\":\"Unsplash\"}]]}]}]]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"introduction\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#introduction\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Introduction\"]}],[\"$\",\"p\",null,{\"children\":[\"Have you ever used a short URL service like bitly or something similar and wondered how it works? Better yet, would you like to create one for yourself? If you've answered yes to both these questions, then you're in the right place. In this article, we'll look at creating a short URL service using \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://workers.cloudflare.com/\",\"children\":\"Cloudflare Workers\"}],\".\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"what-are-cloudflare-workers\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#what-are-cloudflare-workers\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"What are Cloudflare Workers?\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://workers.cloudflare.com/\",\"children\":\"Cloudflare Workers\"}],\" allows you to deploy serverless code to Cloudflare's edge network which means that your code will be available instantly from anywhere across the globe. You don't have to worry about scaling it and the cost to run your code is super cheap. Cloudflare Workers comes with a global, low-latency key-value data store called \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developers.cloudflare.com/workers/learning/how-kv-works\",\"children\":\"Workers KV\"}],\". In this article, we'll be using Workers KV along with Cloudflare Workers.\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-1-sign-up-for-cloudflare\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-1-sign-up-for-cloudflare\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #1: Sign up for Cloudflare\"]}],[\"$\",\"p\",null,{\"children\":[\"Visit \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://cloudflare.com/\",\"children\":\"cloudflare.com\"}],\" and sign up for a free account. Once you've verified your email address and gotten access to your dashboard, you may see a message to add a site â you don't need to add a site, just skip to the dashboard page and click on \",[\"$\",\"strong\",null,{\"children\":\"Workers\"}],\".\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_l5vratkH9Ls6vBw7gUyg_w.png\",\"alt\":\"Screenshot showing how to access Cloudflare Workers.\",\"width\":\"389\",\"height\":\"236\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"Since this is your first time using Cloudflare Workers, you'll be asked to set up a subdomain. This subdomain name is unique to you and will identify all Workers deployed to your account. Enter a suitable subdomain and then click on \",[\"$\",\"strong\",null,{\"children\":\"Set up\"}],\" to proceed to the next step.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_UX8yzI1rPWIC2JUFjPihFQ.png\",\"alt\":\"Screenshot showing how to configure a subdomain for Cloudflare Workers.\",\"width\":\"776\",\"height\":\"603\"}]}]}],[\"$\",\"p\",null,{\"children\":\"In the next step, we'll continue with the free plan since we're going to use this for learning purposes only. In the final step, verify your email and then you're good to go.\"}],[\"$\",\"p\",null,{\"children\":[\"From the Workers dashboard page, you won't see any Workers listed because we haven't created any. For now, just copy the \",[\"$\",\"strong\",null,{\"children\":\"Account ID\"}],\" which should be visible in the right panel.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_fac3j6pJ7ivpLo0y5vMyHg.png\",\"alt\":\"Screenshot showing how to get the account ID from Cloudflare.\",\"width\":\"375\",\"height\":\"305\"}]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-2-set-up-your-development-environment\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-2-set-up-your-development-environment\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #2: Set up your development environment\"]}],[\"$\",\"p\",null,{\"children\":[\"We'll be using the Wrangler CLI for various development tasks, so if you haven't already, please install the CLI tool on your local machine by following \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://developers.cloudflare.com/workers/cli-wrangler/install-update\",\"children\":\"this official Cloudflare guide\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"Login to your Cloudflare account using the Wrangler CLI tool using the command \",[\"$\",\"code\",null,{\"children\":\"wrangler login\"}],\". It's recommended to open up a command prompt with administrator privileges.\"]}],[\"$\",\"p\",null,{\"children\":\"This should open Cloudflare in the browser and you might require to authorize Wrangler. Cloudflare will show a message when it's alright to close the page. Back in the console, you should see a message telling you that everything was successfully configured.\"}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-3-generate-some-code\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-3-generate-some-code\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #3: Generate some code\"]}],[\"$\",\"p\",null,{\"children\":[\"In a local folder, run the command \",[\"$\",\"code\",null,{\"children\":\"wrangler generate shorturl https://github.com/cloudflare/worker-template\"}],\" to generate some code based on a template from Cloudflare's \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/cloudflare/worker-template\",\"children\":\"GitHub repository\"}],\".\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_X_nQAkFFOE6r5VR4t3hdVA.png\",\"alt\":\"Screenshot showing the console output of the entered wrangler commands.\",\"width\":\"805\",\"height\":\"219\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"As instructed in the console output, we need to update the \",[\"$\",\"code\",null,{\"children\":\"wrangler.toml\"}],\" file and add the account ID to that. As per \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/cloudflare/wrangler/issues/209#issuecomment-541654484\",\"children\":\"this comment\"}],\", it's ok to commit the \",[\"$\",\"code\",null,{\"children\":\"wrangler.toml\"}],\" file to source control. The information contained in this file is not sensitive.\"]}],[\"$\",\"$L17\",null,{\"className\":\"language-toml\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-toml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token key property\",\"children\":\"name\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"WORKER_NAME\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token key property\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"javascript\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token key property\",\"children\":\"account_id\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"YOUR ACCOUNT ID\\\"\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"Finally, if you run the command \",[\"$\",\"code\",null,{\"children\":\"wrangler dev\"}],\", you should see the following output.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_gV1OJWEoMxWjjxqIorEwsA.png\",\"alt\":\"Screenshot showing the Worker in action locally.\",\"width\":\"309\",\"height\":\"117\"}]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-4-get-a-short-url-and-redirect\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-4-get-a-short-url-and-redirect\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #4: Get a short URL and redirect\"]}],[\"$\",\"p\",null,{\"children\":[\"In the \",[\"$\",\"code\",null,{\"children\":\"index.js\"}],\" file, replace the \",[\"$\",\"code\",null,{\"children\":\"handleRequest()\"}],\" method with the code snippet below. We're fetching the entire request URL from the object received, then getting the pathname from that, and then simply redirecting the user to example.com with the same pathname suffixed. For example, heading over to our development Worker URL \",[\"$\",\"code\",null,{\"children\":\"127.0.0.1:8787/abc\"}],\" will redirect the user to \",[\"$\",\"code\",null,{\"children\":\"https://example.com/abc\"}],\". If no pathname is supplied, then a simple text message is printed in the browser. Give this a test using the command \",[\"$\",\"code\",null,{\"children\":\"wrangler dev\"}],\".\"]}],[\"$\",\"$L17\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" base \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https://example.com'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" statusCode \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"301\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"handleRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"request\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" url \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"URL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"url\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" pathname \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" url\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" destinationURL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" base \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" pathname\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pathname \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Response\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Hello worker!'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property string-property\",\"children\":\"'content-type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'text/plain'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Response\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"redirect\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"destinationURL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" statusCode\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-5-map-the-path-with-a-static-set\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-5-map-the-path-with-a-static-set\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #5 Map the path with a static set\"]}],[\"$\",\"p\",null,{\"children\":[\"The next step is to make it slightly more dynamic and in line with how the final storage would look like. We've added the \",[\"$\",\"code\",null,{\"children\":\"getRedirectURL()\"}],\" method that simply gets the redirect URL based on the key supplied. In the \",[\"$\",\"code\",null,{\"children\":\"handleRequest()\"}],\" method, we've modified a line to use the \",[\"$\",\"code\",null,{\"children\":\"getRedirectURL()\"}],\" method.\"]}],[\"$\",\"$L17\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" urls \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"google\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https://www.google.com'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"facebook\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https://www.facebook.com'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getRedirectURL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"pathname\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" urls\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"pathname\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"handleRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"request\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Same as before\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" redirectURL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getRedirectURL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pathname\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"replace\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token regex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token regex-delimiter\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token language-regex regex-source\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function anchor\",\"children\":\"^\"}],[\"$\",\"span\",null,{\"className\":\"token escape\",\"children\":\"\\\\/\"}]]}],[\"$\",\"span\",null,{\"className\":\"token regex-delimiter\",\"children\":\"/\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"''\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"redirectURL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Response\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Not a valid identifier'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property string-property\",\"children\":\"'content-type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'text/plain'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Response\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"redirect\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"redirectURL\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" statusCode\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"So far we've got a static list of short URLs and their redirects. Now it's time to make it dynamic.\"}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-6-setting-up-kv-storage\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-6-setting-up-kv-storage\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #6: Setting up KV storage\"]}],[\"$\",\"p\",null,{\"children\":\"Rather than storing a static list of the keys and the corresponding websites it redirects to, we'll be using Cloudflare's KV storage.\"}],[\"$\",\"p\",null,{\"children\":[\"Let's start by running the command \",[\"$\",\"code\",null,{\"children\":\"wrangler kv:namespace create âSHORTURLSâ\"}],\" where \",[\"$\",\"code\",null,{\"children\":\"SHORTURLS\"}],\" is the name I used for my KV namespace. This commands prints a message in the console that instructs to add the KV configuration to the \",[\"$\",\"code\",null,{\"children\":\"wrangler.toml\"}],\" file.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_g_EX-IiZwPppI7nZ-AuL6A.png\",\"alt\":\"Screenshot showing the console output of the entered wrangler commands.\",\"width\":\"633\",\"height\":\"127\"}]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-7-seeding-the-kv-storage\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-7-seeding-the-kv-storage\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #7: Seeding the KV storage\"]}],[\"$\",\"p\",null,{\"children\":\"To quickly test our application out, let's use the following command to add one record into the database.\"}],[\"$\",\"$L17\",null,{\"className\":\"language-shell\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-shell\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"wrangler kv:key put \",[\"$\",\"span\",null,{\"className\":\"token parameter variable\",\"children\":\"--binding\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"BINDING NAME\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" â\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"KEY\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"â â\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"URL\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"\\\"\\n\"]}]}]}],[\"$\",\"p\",null,{\"children\":[\"In the repository I'm working on, I've updated the command to \",[\"$\",\"code\",null,{\"children\":\"wrangler kv:key put --binding=SHORTURLS âtwitterâ âhttps://twitter.com/clydedz\\\"\"}],\". If all goes well, you should immediately see a success message.\"]}],[\"$\",\"p\",null,{\"children\":[\"Now, if you try to run the command \",[\"$\",\"code\",null,{\"children\":\"wrangler dev\"}],\" you should see an error message that might look something like this:\"]}],[\"$\",\"blockquote\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"Error: In order to preview a worker with KV namespaces, you must designate a preview_id in your configuration file for each KV namespace\",[\"$\",\"br\",null,{}],\"you'd like to preview.\"]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_fyYIgdq1T1kMKjppIfD7sg.png\",\"alt\":\"Screenshot showing the console output of the entered wrangler commands.\",\"width\":\"977\",\"height\":\"68\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"After reading \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/cloudflare/wrangler/issues/1458#issuecomment-671465444\",\"children\":\"this useful GitHub answer\"}],\", it became clear that all we needed was a preview environment. When we created the namespace earlier, it was associated with your production environment. So, when you test it out using \",[\"$\",\"code\",null,{\"children\":\"wrangler dev\"}],\", it doesn't let you manipulate your production KV storage from your development environment.\"]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-8-setting-up-a-preview-kv-environment\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-8-setting-up-a-preview-kv-environment\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #8: Setting up a preview KV environment\"]}],[\"$\",\"p\",null,{\"children\":[\"To fix this, we'll need to repeat the KV creation steps exactly as before, but this time we'll add the argument \",[\"$\",\"code\",null,{\"children\":\"--preview\"}],\" indicating that we need a preview, i.e. development instance created.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_X0Y7qIFeesMrK5ZgEr_HGg.png\",\"alt\":\"Screenshot showing the console output of the entered wrangler commands.\",\"width\":\"816\",\"height\":\"101\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"Because we entered the same KV namespace name, notice how the primary \",[\"$\",\"code\",null,{\"children\":\"id\"}],\" is still the same original one, and in addition to that, we've been assigned a \",[\"$\",\"code\",null,{\"children\":\"preview_id\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"If you try to run the application now, the Worker will work but heading over to \",[\"$\",\"code\",null,{\"children\":\"/twitter\"}],\" will not redirect you to the Twitter URL. The reason for this is that we've only seeded our production environment of the KV namespace. Now that we're connecting to preview, we'll also need to seed this preview namespace with a test record. I'm going to run the following command as we did before, but this time I'm going to add the \",[\"$\",\"code\",null,{\"children\":\"--preview\"}],\" argument.\"]}],[\"$\",\"$L17\",null,{\"className\":\"language-shell\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-shell\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"wrangler kv:key put \",[\"$\",\"span\",null,{\"className\":\"token parameter variable\",\"children\":\"--binding\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"SHORTURLS âtwitterâ âhttps://twitter.com/clydedz\\\" --preview.\\n\"]}]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-9-retrieve-values-from-kv-storage\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-9-retrieve-values-from-kv-storage\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #9: Retrieve values from KV storage\"]}],[\"$\",\"p\",null,{\"children\":[\"We'll now update the \",[\"$\",\"code\",null,{\"children\":\"getRedirectURL()\"}],\" method to use our KV namespace to get the value instead of a local static collection. Note, we've written\",[\"$\",\"code\",null,{\"children\":\"SHORTURLS.get()\"}],\" to match our binding name which is named \",[\"$\",\"code\",null,{\"children\":\"SHORTURLS\"}],\". So, if your binding name was \",[\"$\",\"code\",null,{\"children\":\"XYZ\"}],\", then you'd update this code to \",[\"$\",\"code\",null,{\"children\":\"XYZ.get()\"}],\". I've also updated this method to be asynchronous.\"]}],[\"$\",\"$L17\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getRedirectURL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"pathname\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" value \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"SHORTURLS\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pathname\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" value \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"Finally, let's run the application locally to test it out. As you can see in the GIF below, it now works as expected.\"}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_BWD9UbqD9m_K4gjQWvcIpQ.gif\",\"alt\":\"GIF showing the redirection in action.\",\"width\":\"560\",\"height\":\"208\"}]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-10-automating-deployments\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-10-automating-deployments\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #10: Automating deployments\"]}],[\"$\",\"p\",null,{\"children\":\"We wouldn't want to manually deploy our Cloudflare Worker every time we make changes now, would we? For automated deployments, we'll take a look at GitHub Actions since my repository is already source controlled in GitHub.\"}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"github-workflow-file\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#github-workflow-file\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"GitHub workflow file\"]}],[\"$\",\"p\",null,{\"children\":[\"A GitHub workflow file is a YAML file that allows you to configure your build and deploy pipeline via code. I'll explain what we've used for this project, but if you're keen to read more about GitHub workflow, please check out their \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.github.com/en/actions\",\"children\":\"official documentation here\"}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"Let's start by adding the below code snippet to a file called \",[\"$\",\"code\",null,{\"children\":\"build-deploy.yml\"}],\" and store this file in the \",[\"$\",\"code\",null,{\"children\":\".github/workflows/\"}],\" folder.\"]}],[\"$\",\"$L17\",null,{\"className\":\"language-yaml\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-yaml\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" Deploy Cloudflare Worker\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"on\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"push\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"branches\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\"}],\" main\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"jobs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"deploy\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"runs-on\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" ubuntu\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\"}],\"latest\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" Deploy shorturl worker\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"steps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"uses\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" actions/checkout@v2\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" Publish\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"uses\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" cloudflare/wrangler\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"-\"}],\"action@1.3.0\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"with\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"apiToken\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" $\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" secrets.CF_API_TOKEN \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token key atrule\",\"children\":\"workingDirectory\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'shorturl'\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"We start by giving it a nice descriptive name using the \",[\"$\",\"code\",null,{\"children\":\"name\"}],\" keyword. Then, using the \",[\"$\",\"code\",null,{\"children\":\"on\"}],\" keyword, we're configuring this pipeline to run every time code is pushed to the main branch.\"]}],[\"$\",\"p\",null,{\"children\":[\"In the last section of this file, we're using the \",[\"$\",\"code\",null,{\"children\":\"jobs\"}],\" keyword to define a job which is nothing but a batch of steps that will be executed. The keyword \",[\"$\",\"code\",null,{\"children\":\"deploy\"}],\" is just an identifier for this job and could've been named anything else, too. The keyword \",[\"$\",\"code\",null,{\"children\":\"steps\"}],\" contains the individual steps that will make the deployment happen.\"]}],[\"$\",\"p\",null,{\"children\":[\"We're using a GitHub Action from the marketplace called \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/marketplace/actions/checkout\",\"children\":\"actions/checkout\"}],\" to check out the code from our Git repository. Next, we're using \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/marketplace/actions/deploy-to-cloudflare-workers-with-wrangler\",\"children\":\"cloudflare/wrangler-action\"}],\" provided by Cloudflare to deploy our Worker to Cloudflare. Instead of hardcoding the API token, which is required for this step to authenticate against our Cloudflare account, we're using the GitHub secret variable called \",[\"$\",\"code\",null,{\"children\":\"CF_API_TOKEN\"}],\". The prefix \",[\"$\",\"code\",null,{\"children\":\"secrets\"}],\" and the curly braces around it just a syntax for accessing \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://docs.github.com/en/actions/security-guides/encrypted-secrets\",\"children\":\"GitHub secrets\"}],\". Don't worry, we'll look at adding this secret in the next step.\"]}],[\"$\",\"p\",null,{\"children\":[\"We're using the \",[\"$\",\"code\",null,{\"children\":\"workingDirectory\"}],\" keyword to set the working directory of our Cloudflare Worker to a subdirectory (relative to the root directory) because the code for our Worker isn't in the root directory, which is usually the default setting â more on this decision below.\"]}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"cloudflare-token\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#cloudflare-token\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Cloudflare token\"]}],[\"$\",\"p\",null,{\"children\":[\"Navigate to the \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://dash.cloudflare.com/profile/api-tokens\",\"children\":\"API Tokens page\"}],\" in Cloudflare and then click on the \",[\"$\",\"strong\",null,{\"children\":\"Create Token\"}],\" button.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_uHucyp-XXEn32Rqvqfhm0g.png\",\"alt\":\"Screenshot showing how to create a new API token.\",\"width\":\"1049\",\"height\":\"377\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"From the API token templates page, we'll click on the \",[\"$\",\"strong\",null,{\"children\":\"Use template\"}],\" button beside the \",[\"$\",\"strong\",null,{\"children\":\"Edit Cloudflare Workers\"}],\" line item.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_4U7ZaLs4jxiN8oTsWbnUfQ.png\",\"alt\":\"Screenshot showing how to use an existing template to create an API token.\",\"width\":\"720\",\"height\":\"492\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"On the next page, from the \",[\"$\",\"strong\",null,{\"children\":\"Account resources\"}],\" and \",[\"$\",\"strong\",null,{\"children\":\"Zone resources\"}],\" dropdowns, select your account (the email address should show up in these dropdowns) from the dropdown. If you are a user of multiple Cloudflare accounts, you'll need to be careful to select the right account.\"]}],[\"$\",\"p\",null,{\"children\":[\"Continue to the summary, then click on the \",[\"$\",\"strong\",null,{\"children\":\"Create Token\"}],\" button. Copy the token and save it securely.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_F6E6VF-kO35iqU9rC98DCg.png\",\"alt\":\"Screenshot showing how to create a token in Cloudflare.\",\"width\":\"1024\",\"height\":\"332\"}]}]}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"add-secret-in-github\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#add-secret-in-github\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Add secret in GitHub\"]}],[\"$\",\"p\",null,{\"children\":[\"Since we've used the variable \",[\"$\",\"code\",null,{\"children\":\"CF_API_TOKEN\"}],\" in the Workflow file, let's add a secret of the same name in GitHub. Click on \",[\"$\",\"strong\",null,{\"children\":\"Settings\"}],\", then click on \",[\"$\",\"strong\",null,{\"children\":\"Secrets\"}],\" and then \",[\"$\",\"strong\",null,{\"children\":\"New secret\"}],\". Type the secret variable name \",[\"$\",\"code\",null,{\"children\":\"CF_API_TOKEN\"}],\" and in the \",[\"$\",\"strong\",null,{\"children\":\"Value\"}],\" field, enter the Cloudflare API token we generated earlier. Click on \",[\"$\",\"strong\",null,{\"children\":\"Add secret\"}],\" button to save these changes.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_aBbi8J8rKopUZWBPw3A3Bw.png\",\"alt\":\"Screenshot showing how to add a secret in GitHub.\",\"width\":\"1009\",\"height\":\"602\"}]}]}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"step-11-final-checks\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#step-11-final-checks\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Step #11: Final checks\"]}],[\"$\",\"p\",null,{\"children\":[\"Now that we've got all the items in place, don't forget to commit and push the changes to your Workflow file. If everything has been set up well, you should see a successful run in the \",[\"$\",\"strong\",null,{\"children\":\"Actions\"}],\" tab in GitHub.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_y69YYHGn9fnNC6m3hgdQmw.png\",\"alt\":\"Screenshot of the GitHub Actions tab.\",\"width\":\"1265\",\"height\":\"354\"}]}]}],[\"$\",\"p\",null,{\"children\":\"Now, if you head over to the Workers page in your Cloudflare account, you should see the Worker you just deployed pop up on the screen.\"}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_y7ffTi0BLi-TPSJ6ha9jPA.png\",\"alt\":\"Image showing how to see the Worker in the Cloudflare dashboard.\",\"width\":\"814\",\"height\":\"579\"}]}]}],[\"$\",\"p\",null,{\"children\":[\"Head over to the Worker URL and test if the URL redirection works. We can still test the \",[\"$\",\"code\",null,{\"children\":\"\u003cURL of your Worker\u003e/twitter\"}],\" short URL since we seeded that data earlier.\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_YHmeK66PEc-RGyQSIFXtug.gif\",\"alt\":\"GIF showing the redirection in action.\",\"width\":\"674\",\"height\":\"168\"}]}]}],[\"$\",\"hr\",null,{}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"whats-next\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#whats-next\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"What's next?\"]}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"unit-testing\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#unit-testing\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Unit testing\"]}],[\"$\",\"p\",null,{\"children\":\"We didn't look at writing unit tests and setting up test coverage for brevity. However, in a real-life solution, you'd want to consider unit testing your code and also include the required steps in your CI/CD pipeline.\"}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"adding-more-workers\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#adding-more-workers\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Adding more Workers\"]}],[\"$\",\"p\",null,{\"children\":\"In the article above, we only looked at a Worker that redirects us to the destination URL after we supply it with a short URL. If you're trying to create a full-fledged short URL service, you'd also want to create one that allows us to create a new short URL mapping that will act as the backend, and potentially a microservice that will help post analytics for every hit on the short URL and also fetch these analytics back.\"}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_YC-pmfE9i4QZI3qw_HumJQ.png\",\"alt\":\"Diagram showing how multiple Workers come together to form a complete solution.\",\"width\":\"9229\",\"height\":\"5101\"}]}]}],[\"$\",\"p\",null,{\"children\":\"Handdrawn diagram created by the author\"}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"source-controlling-multiple-workers\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#source-controlling-multiple-workers\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Source controlling multiple Workers\"]}],[\"$\",\"p\",null,{\"children\":\"You don't have to create different Git repositories to host each Cloudflare Worker. You can create a monorepo for all your Workers and have subfolders with contents for each Worker. This works great if you're sharing code between different workers, so you don't end up repeating it.\"}],[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/static/posts/1_t6vUl_1ITc5D_P3GpKRS3w.png\",\"alt\":\"Diagram showing how to host multiple workers in the same repository.\",\"width\":\"5080\",\"height\":\"5448\"}]}]}],[\"$\",\"p\",null,{\"children\":\"Handdrawn diagram created by the author\"}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"bundling-into-a-single-javascript-file\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#bundling-into-a-single-javascript-file\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Bundling into a single JavaScript file\"]}],[\"$\",\"p\",null,{\"children\":[\"We've also written all our JavaScript code in a single file which isn't ideal. Out of the box, we cannot import another JavaScript file into our Worker's \",[\"$\",\"code\",null,{\"children\":\"index.js\"}],\" file. To get around this, we can decouple the source code from the final generated Worker JavaScript file. What I mean by that is (also illustrated above), we maintain our source code for a Worker in a folder called \",[\"$\",\"code\",null,{\"children\":\"src\"}],\", for example, and then run a process like \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://webpack.js.org/\",\"children\":\"webpack\"}],\" to bundle and generate a single JavaScript file into a destination folder, let's call this \",[\"$\",\"code\",null,{\"children\":\"dist\"}],\". The contents of this destination folder are what we can then publish to Cloudflare.\"]}],[\"$\",\"h4\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"custom-domain\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#custom-domain\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Custom domain\"]}],[\"$\",\"p\",null,{\"children\":\"If you're building a full-fledge solution, you may also be looking at setting up a custom domain name for your Workers â this is indeed possible and your final solution might look something like the diagram below, using bit.ly as the domain name for reference.\"}],[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"alt\":\"High-level architecture diagram showing all components involved in a full-fledged short URL service.\",\"src\":\"/static/posts/1*cxAr7Kz9jvQZe2y0BxMAEQ.png\"}]}],[\"$\",\"p\",null,{\"children\":\"Handdrawn diagram created by the author\"}],[\"$\",\"hr\",null,{}],[\"$\",\"h3\",null,{\"className\":\"content-header mt-8 mb-6\",\"id\":\"source-code\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#source-code\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Source code\"]}],[\"$\",\"p\",null,{\"children\":[\"If you'd like to see the full source code for this project, it's available on \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/ClydeDz/shorturl-cloudflare-workers\",\"children\":\"GitHub\"}],\". In the same repository, you'll also find a \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/ClydeDz/shorturl-cloudflare-workers/blob/main/cloudflare.ps1\",\"children\":\"PowerShell script\"}],\" that contains all the commands we've used above.\"]}],[\"$\",\"p\",null,{\"children\":\"That's it. Thanks for reading.\"}]]}],[\"$\",\"div\",null,{\"className\":\"pt-6 pb-6 text-center text-gray-700 dark:text-gray-300\",\"id\":\"comment\",\"children\":[\"$\",\"$L18\",null,{\"slug\":\"creating-a-short-url-service-using-cloudflare-workers\"}]}]]}],[\"$\",\"$L19\",null,{\"content\":\"$c:1:props:children:1:props:children:0:props:content\",\"authorDetails\":[{\"name\":\"Clyde D'Souza\",\"avatar\":\"/static/images/clydedsouza.jpg\",\"occupation\":\"Senior Software Engineer. Digital Content Creator.\",\"bio\":\"Hi, I'm Clyde. I'm a software engineer and digital content creator based in Auckland, New Zealand. I write about various technologies, teach online classes, make videos, and I'm also the author of a children's bedtime storybook!\",\"email\":\"address@yoursite.com\",\"twitter\":\"https://twitter.com/clydedz\",\"linkedin\":\"https://www.linkedin.com/in/clydedz/\",\"github\":\"https://github.com/clydedz\",\"kofi\":\"https://ko-fi.com/L3L026ITT\",\"type\":\"Authors\",\"readingTime\":{\"text\":\"1 min read\",\"minutes\":0.18,\"time\":10800,\"words\":36},\"slug\":\"default\",\"path\":\"authors/default\",\"filePath\":\"authors/default.mdx\",\"toc\":[]}],\"next\":{\"title\":\"What are NFTs and why are people buying them?\",\"date\":\"2022-02-06T00:00:00.000Z\",\"tags\":[\"NFT\",\"Metaverse\",\"Blockchain\",\"NFT Collectibles\",\"Cryptocurrency\"],\"readingList\":[],\"lastmod\":\"2022-02-06T00:00:00.000Z\",\"draft\":false,\"subtitle\":\"Everything you need to know about NFTs\",\"images\":[\"/static/posts/nfts.jpg\"],\"type\":\"Blog\",\"readingTime\":{\"text\":\"13 min read\",\"minutes\":12.39,\"time\":743400,\"words\":2478},\"slug\":\"what-are-nfts-and-why-are-people-buying-them\",\"path\":\"posts/what-are-nfts-and-why-are-people-buying-them\",\"filePath\":\"posts/what-are-nfts-and-why-are-people-buying-them.mdx\",\"toc\":[{\"value\":\"Introduction\",\"url\":\"#introduction\",\"depth\":3},{\"value\":\"What is an NFT?\",\"url\":\"#what-is-an-nft\",\"depth\":3},{\"value\":\"Foundational concepts\",\"url\":\"#foundational-concepts\",\"depth\":3},{\"value\":\"Blockchain\",\"url\":\"#blockchain\",\"depth\":4},{\"value\":\"Web 3.0\",\"url\":\"#web-30\",\"depth\":4},{\"value\":\"Cryptocurrency\",\"url\":\"#cryptocurrency\",\"depth\":4},{\"value\":\"Why are people buying NFTs?\",\"url\":\"#why-are-people-buying-nfts\",\"depth\":3},{\"value\":\"Verify ownership and authenticity\",\"url\":\"#verify-ownership-and-authenticity\",\"depth\":4},{\"value\":\"Removes the need for a middle-man\",\"url\":\"#removes-the-need-for-a-middle-man\",\"depth\":4},{\"value\":\"Rarity\",\"url\":\"#rarity\",\"depth\":4},{\"value\":\"Buy, hold and sell\",\"url\":\"#buy-hold-and-sell\",\"depth\":4},{\"value\":\"More than just digital assets\",\"url\":\"#more-than-just-digital-assets\",\"depth\":4},{\"value\":\"Showcase your collectables in the metaverse\",\"url\":\"#showcase-your-collectables-in-the-metaverse\",\"depth\":4},{\"value\":\"Gaming\",\"url\":\"#gaming\",\"depth\":4},{\"value\":\"Interesting use-cases of NFTs around the world\",\"url\":\"#interesting-use-cases-of-nfts-around-the-world\",\"depth\":3}],\"structuredData\":{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"What are NFTs and why are people buying them?\",\"datePublished\":\"2022-02-06T00:00:00.000Z\",\"dateModified\":\"2022-02-06T00:00:00.000Z\",\"description\":\"Everything you need to know about NFTs\",\"image\":\"/static/posts/nfts.jpg\",\"url\":\"https://blog.clydedsouza.net/posts/what-are-nfts-and-why-are-people-buying-them\"}},\"prev\":{\"title\":\"Building a Chrome Extension That Also Runs Like a Website\",\"date\":\"2022-01-17T00:00:00.000Z\",\"tags\":[\"Chrome Extension\",\"Software Design Patterns\",\"Software Development\",\"Design Patterns\",\"Programming\"],\"readingList\":[\"Chrome Extensions\"],\"lastmod\":\"2022-01-17T00:00:00.000Z\",\"draft\":false,\"subtitle\":\"A practical example of factory pattern decoupling\",\"images\":[\"/static/posts/chromeleaves.png\"],\"type\":\"Blog\",\"readingTime\":{\"text\":\"6 min read\",\"minutes\":5.31,\"time\":318600,\"words\":1062},\"slug\":\"building-a-chrome-extension-that-also-runs-like-a-website\",\"path\":\"posts/building-a-chrome-extension-that-also-runs-like-a-website\",\"filePath\":\"posts/building-a-chrome-extension-that-also-runs-like-a-website.mdx\",\"toc\":[{\"value\":\"Problem\",\"url\":\"#problem\",\"depth\":3},{\"value\":\"Solution\",\"url\":\"#solution\",\"depth\":3},{\"value\":\"Step 1: Decoupling the storage implementation details\",\"url\":\"#step-1-decoupling-the-storage-implementation-details\",\"depth\":4},{\"value\":\"Step 2: Decoupling the storage method\",\"url\":\"#step-2-decoupling-the-storage-method\",\"depth\":4},{\"value\":\"References\",\"url\":\"#references\",\"depth\":3}],\"structuredData\":{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Building a Chrome Extension That Also Runs Like a Website\",\"datePublished\":\"2022-01-17T00:00:00.000Z\",\"dateModified\":\"2022-01-17T00:00:00.000Z\",\"description\":\"A practical example of factory pattern decoupling\",\"image\":\"/static/posts/chromeleaves.png\",\"url\":\"https://blog.clydedsouza.net/posts/building-a-chrome-extension-that-also-runs-like-a-website\",\"author\":[{\"@type\":\"Person\",\"name\":\"Clyde D'Souza\"}]}},\"children\":\"$c:1:props:children:1:props:children:1:props:children:0:props:children:0:props:children\"}]]}]]}]]}]]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\ne:null\n"])</script><script>self.__next_f.push([1,"f:null\n13:[[\"$\",\"title\",\"0\",{\"children\":\"Creating a Short URL Service Using Cloudflare Workers | Clyde's Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Deploy serverless code instantly across the globe\"}],[\"$\",\"meta\",\"2\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"3\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"canonical\",\"href\":\"https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers\"}],[\"$\",\"link\",\"5\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://blog.clydedsouza.net/feed.xml\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"Creating a Short URL Service Using Cloudflare Workers\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"Deploy serverless code instantly across the globe\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://blog.clydedsouza.net/posts/creating-a-short-url-service-using-cloudflare-workers\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:site_name\",\"content\":\"Clyde's Blog\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image\",\"content\":\"https://blog.clydedsouza.net/static/posts/guidepost1.jpg\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"13\",{\"property\":\"article:published_time\",\"content\":\"2022-01-27T00:00:00.000Z\"}],[\"$\",\"meta\",\"14\",{\"property\":\"article:modified_time\",\"content\":\"2022-01-27T00:00:00.000Z\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:author\",\"content\":\"Clyde D'Souza\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:title\",\"content\":\"Creating a Short URL Service Using Cloudflare Workers\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:description\",\"content\":\"Deploy serverless code instantly across the globe\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:image\",\"content\":\"https://blog.clydedsouza.net/static/posts/guidepost1.jpg\"}]]\n"])</script></body></html>